# couchdb scrawl
type: leaky
name: aidalinfo/couchdb-bf-ondb
description: "Detect couchdb bruteforce on existing db"
filter: evt.Meta.log_type == 'bf-ondb-couchdb'
leakspeed: "10s"
references:
  # - http://wikipedia.com/ssh-bf-is-bad
capacity: 5
groupby: evt.Meta.source_ip
blackhole: 1m
reprocess: true
labels:
  service: couchdb
  confidence: 3
  spoofable: 0
  classification:
    # - attack.T1110
  label: "SSH Bruteforce"
  remediation: true
---
type: leaky
name: aidalinfo/couchdb-crawl
description: "Detect crawl from single ip"
filter: evt.Meta.log_type == 'couchdb-crawl'
distinct: evt.Meta.path_db
leakspeed: 0.5s
capacity: 40
#debug: true
#this limits the memory cache (and event_sequences in output) to five events
cache_size: 5
groupby: evt.Meta.source_ip
blackhole: 1m
labels:
  service: couchdb
  confidence: 1
  spoofable: 0
  classification:
    # - attack.T1595
  label: "detection of aggressive crawl on couchdb"
  remediation: true